\section{Application to TreeKEM} \label{sec:application-to-treekem}

\subsection{TreeKEM security} \label{sec:treekem-security}

The following theorem, stated informally here and more formally in Section ... of the appendix, is our main practical result.

\begin{theorem}[Informal]
	If the DHIES scheme is used in TreeKEM, the private-key encryption scheme in DHIES is $(t, \eeav)$-EAV-secure and the DDH problem is $(t, \eddh)$-hard in the Diffie-Hellman group, then for all $c, p, u$, TreeKEM is $(\tilde{t}, \tilde{\epsilon}, c, p, u)$-secure in the ROM with $\tilde{t} \approx t$ and
	\begin{align*}
		\tilde{\epsilon} & = 2 \cdot \delta \cdot N \cdot \eeav + 2 \cdot N \cdot \eddh + \frac{2 \cdot \mdh \cdot N^2}{q} + \frac{\ms \cdot N}{2^{\rho - 1}} \\
		\delta           & \coloneqq u                                                                                                                        \\
		N                & \coloneqq 2 \cdot c \cdot \log(u) + u + p
	\end{align*}
	where
	\begin{itemize}
		\item $c$ is the number of commits created
		\item $p$ is the number of add or update proposals created
		\item $u$ is the maximum number of users
		\item $\ms$ is the number of queries to the functions $\hgen$ or $\hdep$ in TreeKEM
		\item $\mdh$ is the number of queries to $\hdh$ in DHIES
		\item $q$ is the size of the Diffie-Hellman group
		\item $\rho$ is the number of bits of randomness used by DHIES for key generation
	\end{itemize}
\end{theorem}

\subsection{Interpreting the result}

Let us go through a concrete example to see what level of security this bound guarantees for TreeKEM. We will look at the \texttt{MLS\_128\_DHKEMX25519\_AES128GCM\_SHA256\_Ed25519} cipher suite specified in \cite{rfc9420}, which uses Curve25519 as the Diffie-Hellman group, SHA2-256 as the key-derivation function in DHIES, and AES with a 128-bit key size for private-key encryption. Both Curve25519 and AES are believed to have a 128-bit security level \todo{citation (Wikipedia?)}, so for example we can set $(t, \eeav) = (t, \eddh) = (2^{80}, 2^{-48})$. The group size for Curve25519 is at least $2^{252}$,  \todo{Can I cite Wikipedia for this?} The seeds sampled in MLS (called ``path secrets" in the RFC) and used as arguments to $\hgen$ and $\hdep$ are 256 bits with SHA2-256 as the key-derivation function, meaning that $\rho = 256$. Furthermore we can set $\mdh \le 2^{60}$ and $\ms \le 2^{61}$.

For the parameters $c$ and $u$ we can consider a large group of about 1000 users, existing for 5 years and making one commit every hour. Then $u \le 2^{10}$ and $c \le 2^{16}$. For $p$, if we assume that a significant fraction of the users will want to update with every commit and that add proposals are rare, then we can bound it by $p \le c \cdot u$.

These numbers yield the following results:
\begin{align*}
	\delta & \le 2^{10}, N \le 2^{27}                                                      \text{ (dominated by $p$)} \\
	\et    & \le 2^{37} \cdot \eeav + 2^{27} \cdot \eddh + \frac{1}{2^{136}}                                          \\
	       & \le \frac{1}{2^{10}}
\end{align*}
with the $\eeav$ term dominating the result. This gives a security level of $\tilde{t}/\et \ge 2^{90}$. Since private-key encryption is relatively cheap, using 256-bit AES would have a small impact on the performance and would increase the security level to 100 bits. Lastly, using 256-bit AES and a Diffie-Hellman group with a 256-bit security level yields 139 bits of security for TreeKEM.

The previous best result in \cite[Theorem 3]{ttkem} proved a bound with
\[
	\et \le 2 \cdot N^2 \cdot \epsilon + \mathrm{negl}(\eta)
\]
for the GSD game, where $\epsilon$ is the IND-CPA security of the underlying public-key encryption scheme. Using the above parameters for a 128-bit security level this implies only 73 bits of security (and the result remains unchanged with 256-bit AES). Therefore, our result significantly improves the guaranteed security level of TreeKEM (in the ROM).
